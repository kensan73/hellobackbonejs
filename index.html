<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Welcome</title>
    <script type="text/javascript"
            src="http://cdnjs.cloudflare.com/ajax/libs/coffee-script/1.1.2/coffee-script.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.0/underscore-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js"></script>
    <script type="text/coffeescript">
        window.learning = ->
            "I am learning coffeescript"
    </script>
    <script type="text/javascript">
      setTimeout(function () {
        console.log(window.learning());
      }, 1000);
    </script>
</head>
<body>
</body>
<script type="text/coffeescript">
    jQuery ->
        class Item extends Backbone.Model
            defaults:
                part1: 'Hello'
                part2: 'Backbone'

        class List extends Backbone.Collection
            model: Item

        class ListView extends Backbone.View
            el: $ 'body'

            initialize: ->
                _.bindAll(@, _.functions(this))
                @collection = new List
                @collection.bind 'add', @appendItem
                @counter = 0
                @render()

            render: ->
                $(@el).append '<h1>Hello, Backbone!</h1>'
                $(@el).append '<button>Add List Item</button>'
                $(@el).append '<ul></ul>'

            addItem: ->
                @counter++
                console.log 'gh1'
                @item = new Item
                console.log 'gh2:',@item
                @item.set part2: "#{@item.get 'part2'} #{@counter}"
                console.log 'gh3',@collection
                @collection.add @item
                console.log 'gh4'

            appendItem: ->
                $('ul').append "<li>#{@item.get 'part1'} #{@item.get 'part2'}!</li>"

            events:
                'click button': 'addItem'

        list_view = new ListView
</script>

</html>